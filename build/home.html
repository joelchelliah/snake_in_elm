<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>snake</title><script type="text/javascript" src="./elm-runtime.js"></script><script type="text/javascript">Elm.Main = Elm.Main || {};
Elm.Main.make = function (_elm) {
   _elm.Main = _elm.Main || {};
   if (_elm.Main.values)
   return _elm.Main.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _E = _N.Error.make(_elm),
   _J = _N.JavaScript.make(_elm),
   $moduleName = "Main";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var Keyboard = Elm.Keyboard.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Prelude = Elm.Prelude.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var Window = Elm.Window.make(_elm);
   var _op = {};
   var redTxt = function (f) {
      return function ($) {
         return Text.text(f(Text.bold(Text.color(Color.darkRed)(Text.toText($)))));
      };
   };
   var whtTxt = function (f) {
      return function ($) {
         return Text.text(f(Text.italic(Text.color(Color.white)(Text.toText($)))));
      };
   };
   var bluTxt = function (f) {
      return function ($) {
         return Text.text(f(Text.monospace(Text.color(Color.blue)(Text.toText($)))));
      };
   };
   var scoreTxt = function (g) {
      return _L.append(Prelude.show(g.points),
      " points");
   };
   var vecEqual = F2(function (_v0,
   _v1) {
      return function () {
         switch (_v1.ctor)
         {case "_Tuple2":
            return function () {
                 switch (_v0.ctor)
                 {case "_Tuple2":
                    return _U.eq(Basics.floor(_v0._0 - _v1._0),
                      0) && _U.eq(Basics.floor(_v0._1 - _v1._1),
                      0);}
                 _E.Case($moduleName,
                 "on line 92, column 30 to 74");
              }();}
         _E.Case($moduleName,
         "on line 92, column 30 to 74");
      }();
   });
   var vecAdd = F2(function (_v8,
   _v9) {
      return function () {
         switch (_v9.ctor)
         {case "_Tuple2":
            return function () {
                 switch (_v8.ctor)
                 {case "_Tuple2":
                    return {ctor: "_Tuple2"
                           ,_0: _v8._0 + _v9._0
                           ,_1: _v8._1 + _v9._1};}
                 _E.Case($moduleName,
                 "on line 89, column 29 to 45");
              }();}
         _E.Case($moduleName,
         "on line 89, column 29 to 45");
      }();
   });
   var stepFood = F3(function (body,
   f,
   eaten) {
      return eaten ? _U.replace([["pos"
                                 ,List.last(body)]
                                ,["color",List.last(f.colors)]
                                ,["colors"
                                 ,{ctor: "::"
                                  ,_0: List.last(f.colors)
                                  ,_1: A2(List.take,
                                  List.length(f.colors) - 1,
                                  f.colors)}]],
      f) : f;
   });
   var defaultFood = {_: {}
                     ,color: Color.green
                     ,colors: _J.toList([Color.green
                                        ,Color.lightBlue
                                        ,Color.yellow
                                        ,Color.lightRed
                                        ,Color.lightPurple
                                        ,Color.lightBrown])
                     ,pos: {ctor: "_Tuple2"
                           ,_0: 0
                           ,_1: 0}};
   var Food = F3(function (a,b,c) {
      return {_: {}
             ,color: b
             ,colors: c
             ,pos: a};
   });
   var Snake = F4(function (a,
   b,
   c,
   d) {
      return {_: {}
             ,body: d
             ,length: c
             ,pos: a
             ,vel: b};
   });
   var Game = F4(function (a,
   b,
   c,
   d) {
      return {_: {}
             ,food: b
             ,points: c
             ,snake: a
             ,state: d};
   });
   var Over = {ctor: "Over"};
   var deathTxt = function (g) {
      return _U.eq(g.state,
      Over) && !_U.eq(g.points,
      0) ? "Game over" : "";
   };
   var againTxt = function (g) {
      return _U.eq(g.state,
      Over) ? "Hit space to start a new game." : "";
   };
   var Play = {ctor: "Play"};
   var Input = F4(function (a,
   b,
   c,
   d) {
      return {_: {}
             ,arrowX: b
             ,arrowY: c
             ,delta: d
             ,space: a};
   });
   var delta = A2(Signal._op["<~"],
   Time.inSeconds,
   Time.fps(20));
   var input = A2(Signal.sampleOn,
   delta,
   A2(Signal._op["~"],
   A2(Signal._op["~"],
   A2(Signal._op["~"],
   A2(Signal._op["<~"],
   Input,
   Keyboard.space),
   A2(Signal.lift,
   function (_) {
      return _.x;
   },
   Keyboard.arrows)),
   A2(Signal.lift,
   function (_) {
      return _.y;
   },
   Keyboard.arrows)),
   delta));
   var $ = {ctor: "_Tuple2"
           ,_0: 600
           ,_1: 400},
   width = $._0,
   height = $._1;
   var $ = {ctor: "_Tuple2"
           ,_0: width / 2
           ,_1: height / 2},
   hWidth = $._0,
   hHeight = $._1;
   var pointsNormalizer = 14;
   var pointsReward = 10;
   var grid = 10;
   var $ = {ctor: "_Tuple2"
           ,_0: width - grid
           ,_1: height - grid},
   iWidth = $._0,
   iHeight = $._1;
   var defaultSnake = {_: {}
                      ,body: _J.toList([])
                      ,length: 10
                      ,pos: {ctor: "_Tuple2"
                            ,_0: 2 * grid - hWidth
                            ,_1: 0}
                      ,vel: {ctor: "_Tuple2"
                            ,_0: grid
                            ,_1: 0}};
   var defaultGame = {_: {}
                     ,food: defaultFood
                     ,points: 0
                     ,snake: defaultSnake
                     ,state: Over};
   var stepSnake = F3(function (_v16,
   s,
   ateFood) {
      return function () {
         return _U.replace([["vel"
                            ,!_U.eq(_v16.arrowX,
                            0) && _U.eq(Basics.fst(s.vel),
                            0) ? {ctor: "_Tuple2"
                                 ,_0: Basics.toFloat(_v16.arrowX * grid)
                                 ,_1: 0} : !_U.eq(_v16.arrowY,
                            0) && _U.eq(Basics.snd(s.vel),
                            0) ? {ctor: "_Tuple2"
                                 ,_0: 0
                                 ,_1: Basics.toFloat(_v16.arrowY * grid)} : s.vel]
                           ,["pos",A2(vecAdd,s.pos,s.vel)]
                           ,["length"
                            ,s.length + (ateFood ? 10 : 0)]
                           ,["body"
                            ,{ctor: "::"
                             ,_0: s.pos
                             ,_1: _U.cmp(List.length(s.body),
                             s.length) > -1 ? A2(List.take,
                             s.length - 1,
                             s.body) : s.body}]],
         s);
      }();
   });
   var stepGame = F2(function (input,
   g) {
      return function () {
         var snakeEatsFood = A2(vecEqual,
         g.food.pos,
         g.snake.pos);
         return _U.eq(g.state,
         Play) ? _U.replace([["snake"
                             ,A3(stepSnake,
                             input,
                             g.snake,
                             snakeEatsFood)]
                            ,["food"
                             ,A3(stepFood,
                             g.snake.body,
                             g.food,
                             snakeEatsFood)]
                            ,["points"
                             ,snakeEatsFood ? g.points + pointsReward * g.snake.length : g.points - Basics.ceiling(Basics.toFloat(g.snake.length) / pointsNormalizer)]
                            ,["state"
                             ,_U.cmp(Basics.abs(Basics.fst(g.snake.pos)),
                             hWidth - grid) > 0 ? Over : _U.cmp(Basics.abs(Basics.snd(g.snake.pos)),
                             hHeight - grid) > 0 ? Over : A2(List.any,
                             vecEqual(g.snake.pos),
                             g.snake.body) ? Over : Play]],
         g) : input.space ? _U.replace([["state"
                                        ,Play]],
         defaultGame) : g;
      }();
   });
   var borderLine = _U.replace([["width"
                                ,grid]
                               ,["color",Color.lightGray]],
   Graphics.Collage.defaultLine);
   var display = F2(function (_v18,
   game) {
      return function () {
         switch (_v18.ctor)
         {case "_Tuple2":
            return function () {
                 var drawAgainTxt = Graphics.Collage.move({ctor: "_Tuple2"
                                                          ,_0: 0
                                                          ,_1: 0 - 30})(Graphics.Collage.toForm(whtTxt(Text.height(20))(againTxt(game))));
                 var drawDeathTxt = Graphics.Collage.move({ctor: "_Tuple2"
                                                          ,_0: 0
                                                          ,_1: 10})(Graphics.Collage.toForm(redTxt(Text.height(50))(deathTxt(game))));
                 var drawScoreTxt = Graphics.Collage.move({ctor: "_Tuple2"
                                                          ,_0: 0
                                                          ,_1: hHeight - 30})(Graphics.Collage.toForm(bluTxt(Text.height(30))(scoreTxt(game))));
                 var drawFood = Graphics.Collage.move(game.food.pos)(Graphics.Collage.filled(_U.eq(game.state,
                 Over) ? Color.black : game.food.color)(Graphics.Collage.square(grid)));
                 var drawSnake = function (pos) {
                    return Graphics.Collage.move(pos)(Graphics.Collage.filled(_U.eq(game.state,
                    Over) ? Color.black : Color.white)(Graphics.Collage.square(grid)));
                 };
                 var drawBorders = Graphics.Collage.outlined(borderLine)(A2(Graphics.Collage.rect,
                 iWidth,
                 iHeight));
                 var drawBackground = Graphics.Collage.filled(Color.black)(A2(Graphics.Collage.rect,
                 width,
                 height));
                 return Graphics.Element.color(Color.charcoal)(A3(Graphics.Element.container,
                 _v18._0,
                 _v18._1,
                 Graphics.Element.middle)(A3(Graphics.Collage.collage,
                 width,
                 height,
                 {ctor: "::"
                 ,_0: drawBackground
                 ,_1: {ctor: "::"
                      ,_0: drawSnake(game.snake.pos)
                      ,_1: _L.append(A2(List.map,
                      drawSnake,
                      game.snake.body),
                      _J.toList([drawFood
                                ,drawBorders
                                ,drawScoreTxt
                                ,drawDeathTxt
                                ,drawAgainTxt]))}})));
              }();}
         _E.Case($moduleName,
         "between lines 101 and 116");
      }();
   });
   var main = A2(Signal._op["~"],
   A2(Signal._op["<~"],
   display,
   Window.dimensions),
   A3(Signal.foldp,
   stepGame,
   defaultGame,
   input));
   _elm.Main.values = {_op: _op
                      ,grid: grid
                      ,pointsReward: pointsReward
                      ,pointsNormalizer: pointsNormalizer
                      ,height: height
                      ,width: width
                      ,iHeight: iHeight
                      ,iWidth: iWidth
                      ,hHeight: hHeight
                      ,hWidth: hWidth
                      ,delta: delta
                      ,input: input
                      ,defaultGame: defaultGame
                      ,defaultSnake: defaultSnake
                      ,defaultFood: defaultFood
                      ,stepGame: stepGame
                      ,stepSnake: stepSnake
                      ,stepFood: stepFood
                      ,vecAdd: vecAdd
                      ,vecEqual: vecEqual
                      ,display: display
                      ,scoreTxt: scoreTxt
                      ,deathTxt: deathTxt
                      ,againTxt: againTxt
                      ,bluTxt: bluTxt
                      ,whtTxt: whtTxt
                      ,redTxt: redTxt
                      ,borderLine: borderLine
                      ,main: main
                      ,Play: Play
                      ,Over: Over
                      ,Input: Input
                      ,Game: Game
                      ,Snake: Snake
                      ,Food: Food};
   return _elm.Main.values;
};</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.Main)</script><noscript></noscript></body></html>